---
- name: MariaDB
  level: 0
  default_port:
    - mysql
  protocol: tcp
  regexps:
    regexp:
      - Host .* is not allowed to connect to this MariaDB server
      - "^.\0\0\0\n(5\\.[-_~.+:\\w]+MariaDB-[-_~.+:\\w]+)\0"
- name: MySQL
  level: 0
  default_port:
    - mysql
  protocol: tcp
  regexps:
    regexp:
      - "^.\0\0\0\n(.\\.[-_~.+\\w]+)\0"
      - "^.\0\0\0ÿj\x04'[\\d.]+' .* MySQL"
      - Host .* is not allowed to connect to this MySQL server
- name: redis
  level: 1
  vuln: redis_unauthorized
  default_port:
    - redis
  protocol: tcp
  send_data: "info\n"
  regexps:
    vuln:
      - redis_version:(.*)
    regexp:
      - "-NOAUTH"
      - "-ERR"
      - "-DENIED"
- name: memcahce
  level: 1
  vuln: memcahce_unauthorized
  default_port:
    - '11211'
  protocol: tcp
  send_data: "stats\n"
  regexps:
    vuln:
      - STAT version (.*)
- name: dubbo-remote
  level: 0
  vuln: dubbo_unauthorized
  default_port:
    - dubbo
  protocol: tcp
  regexps:
    vuln:
      - dubbo
- name: 深信服设备
  level: 0
  default_port:
    - '9000'
  protocol: tcp
  regexps:
    regexp:
      - yesorno
- name: VNC
  level: 0
  default_port:
    - vnc
  protocol: tcp
  regexps:
    regexp:
      - RFB 00
- name: SSH
  level: 0
  default_port:
    - ssh
  protocol: tcp
  regexps:
    regexp:
      - SSH-
- name: RSYNC
  level: 0
  default_port:
    - '873'
  protocol: tcp
  regexps:
    regexp:
      - "@RSYNC:"
      - "@ERROR:"
- name: JAVA-RMI
  level: 1
  default_port:
    - jndi
  send_data: "JRMI\0\x02K"
  protocol: tcp
  regexps:
    regexp:
      - N.{1,2}\d*\.\d*\.\d*\.\d*
- name: FTP
  level: 0
  default_port:
    - ftp
  protocol: tcp
  regexps:
    regexp:
      - FTPd
      - FTP service
      - 220-FileZilla
- name: RTSP
  level: 0
  default_port:
    - '554'
  protocol: tcp
  regexps:
    regexp:
      - RTSP/1
- name: ice
  level: 0
  default_port:
    - '5000'
    - '10000'
  protocol: tcp
  regexps:
    regexp:
      - IceP
- name: sqlserver
  level: 1
  default_port:
    - '1433'
  send_data: b64|EgEANAAAAAAAABUABgEAGwABAgAcAAwDACgABP8IAAFVAAAATVNTUUxTZXJ2ZXIASA8AAA==
  protocol: tcp
  regexps:
    regexp:
      - "^\x04\x01\0%\0\0\x01\0\0\0\x15\0\x06\x01\0\e\0\x01\x02"
- name: oracle
  level: 1
  default_port:
    - '1521'
  send_data: b64|AFoAAAEAAAABNgEsAAAIAH//fwgAAAABACAAOgAAAAAAAAAAAAAAAAAAAAA05gAAAAEAAAAAAAAAAChDT05ORUNUX0RBVEE9KENPTU1BTkQ9dmVyc2lvbikp
  protocol: tcp
  regexps:
    regexp:
      - DESCRIPTION=
- name: rdp
  level: 1
  default_port:
    - '3389'
  send_data: b64|AwAAKiXgAAAAAABDb29raWU6IG1zdHNoYXNoPW5tYXANCgEACAADAAAA
  protocol: tcp
  regexps:
    regexp:
      - "^\x03\0\0"
- name: postgresql
  level: 1
  default_port:
    - '5432'
  send_data: b64|AAAApP9TTUJyAAAAAAgBQAAAAAAAAAAAAAAAAAAAQAYAAAEAAIEAAlBDIE5FVFdPUksgUFJPR1JBTSAxLjAAAk1JQ1JPU09GVCBORVRXT1JLUyAxLjAzAAJNSUNST1NPRlQgTkVUV09SS1MgMy4wAAJMQU5NQU4xLjAAAkxNMS4yWDAwMgACU2FtYmEAAk5UIExBTk1BTiAxLjAAAk5UIExNIDAuMTIA
  protocol: tcp
  regexps:
    regexp:
      - "^E\0\0\0"
